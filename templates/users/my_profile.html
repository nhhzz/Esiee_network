{% extends "base.html" %}
{% block content %}

<div class="container py-4" style="max-width: 1000px;">

  <!-- Header du profil -->
  <div class="d-flex justify-content-between align-items-center mb-4">

    <div class="d-flex align-items-center gap-3">
      {% if user_obj.profile_image %}
        <img src="{{ user_obj.profile_image.url }}"
             alt="Photo de profil"
             class="rounded-circle"
             style="width:72px; height:72px; object-fit:cover;">
      {% else %}
        <div class="rounded-circle bg-secondary text-white d-flex align-items-center justify-content-center"
             style="width:72px; height:72px;">
          {{ user_obj.username|first|upper }}
        </div>
      {% endif %}

      <div>
        {% if is_self %}
          <h1 class="mb-1">Mon profil</h1>
        {% else %}
          <h1 class="mb-1">Profil de {{ user_obj.username }}</h1>
        {% endif %}
        <p class="text-muted mb-0">
          {{ user_obj.username }} ‚Äî {{ user_obj.email }}
        </p>
      </div>
    </div>

    {% if is_self %}
      <a href="{% url 'users:profile' %}" class="btn btn-outline-primary btn-sm">
        Modifier le profil
      </a>
    {% endif %}
  </div>

  <div class="row g-4">

    <!-- Colonne gauche : Posts -->
    <div class="col-md-6">
      {% if is_self %}
        <h4 class="mb-3">Mes publications</h4>
      {% else %}
        <h4 class="mb-3">Publications de {{ user_obj.username }}</h4>
      {% endif %}

      {% if posts %}
        <div class="list-group">
          {% for post in posts %}
            <div class="list-group-item">
              <div class="fw-semibold">
                {{ post.title }}
              </div>
              <div class="small text-muted">
                {{ post.get_post_type_display }} ‚Äî {{ post.created_at|date:"d/m/Y H:i" }}
              </div>
              <p class="mb-1 mt-2">
                {{ post.content|truncatechars:120 }}
              </p>
            </div>
          {% endfor %}
        </div>
      {% else %}
        <p class="text-muted">
          {% if is_self %}
            Tu n'as pas encore publi√© de post.
          {% else %}
            {{ user_obj.username }} n'a pas encore publi√© de post.
          {% endif %}
        </p>
      {% endif %}
    </div>

    <!-- Colonne droite : √âv√©nements -->
    <div class="col-md-6">
      {% if is_self %}
        <h4 class="mb-3">Mes √©v√©nements</h4>
      {% else %}
        <h4 class="mb-3">√âv√©nements de {{ user_obj.username }}</h4>
      {% endif %}

      {% if events %}
        <div class="list-group">
          {% for event in events %}
            <a href="{% url 'events:detail' event.pk %}"
               class="list-group-item list-group-item-action">
              <div class="fw-semibold">
                {{ event.title }}
              </div>
              <div class="small text-muted">
                üìç {{ event.get_location_display }}
                ‚Äî üïí {{ event.start_at|date:"d/m/Y H:i" }}
              </div>
            </a>
          {% endfor %}
        </div>
      {% else %}
        <p class="text-muted">
          {% if is_self %}
            Tu n'as pas encore cr√©√© d'√©v√©nement.
          {% else %}
            {{ user_obj.username }} n'a pas encore cr√©√© d'√©v√©nement.
          {% endif %}
        </p>
      {% endif %}
    </div>

  </div>
</div>

{% endblock %}
